---
import Metadata from "components/Metadata.astro";
import { getI18n } from "src/i18n/i18n";
import { convert } from "src/utils/currencies";

interface Props {
  price: {
    amount: number;
    currency: string;
  };
}

const { price } = Astro.props;
const { formatPrice, t } = await getI18n(Astro.locals.currentLocale);

const preferredCurrency = Astro.locals.currentCurrency;

const convertedPrice = {
  amount: convert(price.currency, preferredCurrency, price.amount),
  currency: preferredCurrency,
};

let priceText = price.amount === 0 ? t("collectibles.price.free") : formatPrice(price);

if (price.amount > 0 && price.currency !== convertedPrice.currency) {
  priceText += `â€€(${formatPrice(convertedPrice)})`;
}
---

{/* ------------------------------------------- HTML ------------------------------------------- */}

<Metadata
  icon="material-symbols:sell-outline"
  title={t("collectibles.price")}
  values={[{ name: priceText }]}
  withBorder={false}
/>
