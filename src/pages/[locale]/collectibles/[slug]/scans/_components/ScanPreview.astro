---
import { getI18n } from "src/i18n/i18n";
import type { EndpointScanImage } from "src/shared/payload/payload-sdk";
import { sizesToSrcset } from "src/utils/img";

interface Props {
  scan: EndpointScanImage;
  collectibleSlug: string;
}

const {
  scan: { url, index, width, height, sizes },
  collectibleSlug,
} = Astro.props;

const { getLocalizedUrl, formatScanIndexShort } = await getI18n(Astro.locals.currentLocale);
---

{/* ------------------------------------------- HTML ------------------------------------------- */}

<a href={getLocalizedUrl(`/collectibles/${collectibleSlug}/scans/${index}`)}>
  <img
    src={url}
    srcset={sizesToSrcset(sizes)}
    sizes={`
      (max-width: ${(width / height) * 320}px) 90vw,
      ${(width / height) * 320}px`}
    width={width}
    height={height}
  />
  <p>{formatScanIndexShort(index)}</p>
</a>

{/* ------------------------------------------- CSS -------------------------------------------- */}

<style>
  a {
    display: flex;
    flex-direction: column;
    gap: 1em;
    text-align: center;
    place-items: center;

    transition: 100ms scale;

    &:hover {
      scale: 104%;
    }

    & > img {
      max-height: 320px;
      max-width: 100%;
      height: auto;
      width: auto;
      aspect-ratio: auto 21/29.7;
      box-shadow: 0 5px 20px -10px var(--color-shadow);
    }
  }
</style>
